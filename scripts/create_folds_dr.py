#!/usr/bin/env python3# -*- coding: utf-8 -*-import osimport randomlabeled_data_dir = 'sample@500/train'UNLABELED = 2000unlabeled_data_dir = 'sample@{}/train'.format(UNLABELED)val_data_dir = 'test'class_dirs = ['0', '1']out_dir = 'folds_dr_{}'.format(UNLABELED)os.makedirs(out_dir, exist_ok=True)def write_csv(data, fname):    with open(fname, 'w') as f:        for sample in data:            f.write('{},{}\n'.format(sample[0], sample[1]))                        def create_tuples(data_dir):    data_by_class = {}    list_tuples = []    class_dirs = ['0', '1']        for c in class_dirs:        label = int(c)        data_by_class[label] = []        for img_file in os.listdir(os.path.join(data_dir,c)):            path = os.path.join(data_dir, c, img_file)            data_by_class[label].append((path,label))        random.shuffle(data_by_class[label])        list_tuples.extend(data_by_class[label])            return list_tupleslabeled = create_tuples(labeled_data_dir)unlabeled = create_tuples(unlabeled_data_dir)val = create_tuples(val_data_dir)test = create_tuples(val_data_dir)# Save CSV files write_csv(labeled, os.path.join(out_dir, 'train_labeled.csv'))write_csv(unlabeled, os.path.join(out_dir, 'train_unlabeled.csv'))write_csv(test, os.path.join(out_dir, 'test.csv'))write_csv(val, os.path.join(out_dir, 'val.csv'))